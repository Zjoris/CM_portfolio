---
title: "Cognitive Musicology Portfolio"
output: html_document
---
# Analysing daily mixes and discover weekly playlists


As an active Spotify user I often contemplate about maintaining an enormous playlist of songs that I like. However, in my opinion, if you really like a song you'll remember it, so there is no need for a playlist to remind you of what songs you like.
That being said, I do need some type of playlist to get my day started. Therefore I listen to my daily mixes almost exclusively. Occasionally I listen to my discover weekly playlist that always surprises me with its quality of recommended songs. Somehow these playlists seem fresh every time while at the same time containing a lot of songs that I know and love. 

This made me wonder how these playlists vary from day to day and week to week and how my discover weekly relates to my daily mixes.

Therefore I will be analyzing my daily mixes and discover weekly playlists for the duration of 8 weeks. The interest lies mostly on the relation between the daily mixes and the discover weekly playlist.
There is two things I hope to discover:

(1) Is there a way to predict my discover weekly playlist of the next week based on my daily mixes of the current week.

(2) Is there a way to predict which daily mixes I listened to in the previous week(s) based on my discover weekly playlist. 

My daily mixes usually range from playlists containing Pixies and the Velvet Underground to playlists containing Miles Davis and Charlie Parker to playlists containing Eagles of death metal and the Black keys to playlists containing Canned heat and Roy Buchannan. Sometimes my daily mixes vary a lot with regard to each other, causing my discover weekly playlist to be a total mess sometimes. This will be very interesting to analyze.


```{r}
library(dbplyr)
library(tidyverse)
library(spotifyr)
library(ggplot2)
```




```{r}
## This does not work, get_spotify_authorization_code() redirects me to an invalid URI 
#get_user_playlists("kmkov4v2xhms7od6p3gq32wfv",limit = 50,authorization = get_spotify_authorization_code())
```

At the moment I analyzed if there is a difference between my first two discover weekly playlists. Once I get the authorization working properly I can easily retrieve my daily mixes (which are about 48 at the moment). 


```{r}
# Get playlists

W1 <- get_playlist_audio_features("","63hsDrXOJGXHlVIiTHyLS9")
W2 <- get_playlist_audio_features("","456ZJtJ9UCUSKr3vqzUMWK")

W1_2 <- bind_rows(
  W1 %>% mutate(cat = "weekly 1"),
  W2 %>% mutate(cat = "weekly 2")
)

```


```{r}
W1_2 %>%
  mutate(
    mode = ifelse(mode == 0, "Minor", "Major")
  ) %>%
  ggplot(aes(x = valence, y = energy,color = tempo,size = loudness,shape=mode)) + geom_point(alpha=0.5) +facet_wrap(~cat)
```
In terms of energy/valence the two discover weeklies are distributed fairly similar.
However Weekly 1 is more scattered whereas weekly 2 can be divided into two groups (seen in next plot). Loudness is pretty much the same among all songs. 
Both playlists consist of mostly major songs which, honestly, was to my surprise. 
Something interesting in weekly 2 is that the songs with highest valence and highest energy are songs in a minor key.
```{r}
W1_2 %>%
  ggplot(aes(x = cat,y=energy)) + geom_violin()
```
```{r}
int2key <- function(i) {
  out = case_when(
    i == 0 ~ "C",
    i == 1 ~ "C#",
    i == 2 ~ "D",
    i == 3 ~ "D#",
    i == 4 ~ "E",
    i == 5 ~ "F",
    i == 6 ~ "F#",
    i == 7 ~ "G",
    i == 8 ~ "G#",
    i == 9 ~ "A",
    i == 10 ~ "A#",
    i == 11 ~ "B"
  )
  return(out)
}
  
W1_2 %>%
  mutate(key = int2key(key)) %>%
  ggplot(aes(key)) +geom_bar(binwidth=0.6,fill="light green",alpha=0.8) + facet_wrap(~cat)
```

Weekly 1 seems to be mostly in "A". This makes sense because the songs in that playlist have a lot more simplicity to them. And A is a pretty "go to" key in my opinion.


